name: "onDiscussionCreated"
on:
  discussion:
    types: [created]
jobs:
  main:
    runs-on: ubuntu-22.04
    steps:
      - name: "escape object"
        run: echo "PAYLOAD=$(sed 's/'\''/'\\\\\''/g' ${{ env.EVENT }})" >> $GITHUB_ENV
        env:
          EVENT: ${{ toJson(github.event) }}
      - name: "Send notification"
        run: |
          curl -i -H 'Content-Type: application/json' -d '${{ env.PAYLOAD }}' -L '${{ env.ON_DISCUSSION_CREATED_URL }}'
        env:
          EVENT: ${{ toJson(github.event) }}
          ON_DISCUSSION_CREATED_URL: ${{ secrets.ON_DISCUSSION_CREATED_URL }}
